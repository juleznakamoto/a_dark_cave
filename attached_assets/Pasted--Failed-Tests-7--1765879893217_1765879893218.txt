
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should trigger test event when Ashen Greatshield is equipped
TypeError: Cannot read properties of undefined (reading 'condition')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:135:18
    133|     const event = villageAttackEvents.testAshenGreatshield;
    134|     
    135|     expect(event.condition(mockState)).toBe(true);
       |                  ^
    136|   });
    137| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should not trigger if shield is not equipped
TypeError: Cannot read properties of undefined (reading 'condition')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:142:18
    140|     const event = villageAttackEvents.testAshenGreatshield;
    141|     
    142|     expect(event.condition(mockState)).toBe(false);
       |                  ^
    143|   });
    144| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should not trigger if already seen
TypeError: Cannot read properties of undefined (reading 'condition')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:149:18
    147|     const event = villageAttackEvents.testAshenGreatshield;
    148|     
    149|     expect(event.condition(mockState)).toBe(false);
       |                  ^
    150|   });
    151| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should reduce deaths by 25% with Ashen Greatshield
TypeError: Cannot read properties of undefined (reading 'choices')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:154:26
    152|   it('should reduce deaths by 25% with Ashen Greatshield', () => {
    153|     const event = villageAttackEvents.testAshenGreatshield;
    154|     const choice = event.choices![0];
       |                          ^
    155|     
    156|     // Run the test multiple times to verify average reduction

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should mark event as seen after completion
TypeError: Cannot read properties of undefined (reading 'choices')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:177:26
    175|   it('should mark event as seen after completion', () => {
    176|     const event = villageAttackEvents.testAshenGreatshield;
    177|     const choice = event.choices![0];
       |                          ^
    178|     
    179|     const result = choice.effect!(mockState);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should include damage reduction info in log message
TypeError: Cannot read properties of undefined (reading 'choices')
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:186:26
    184|   it('should include damage reduction info in log message', () => {
    185|     const event = villageAttackEvents.testAshenGreatshield;
    186|     const choice = event.choices![0];
       |                          ^
    187|     
    188|     const result = choice.effect!(mockState);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯

 FAIL  client/src/game/rules/eventsVillageAttacks.test.ts > Ashen Greatshield Event Death Reduction > should verify killVillagers applies death reduction correctly
AssertionError: expected 10 to be less than 10
 ❯ client/src/game/rules/eventsVillageAttacks.test.ts:204:26
    202|     
    203|     // The reduction should be noticeable
    204|     expect(actualDeaths).toBeLessThan(deathCount);
       |                          ^
    205|     // Should be around 7-8 deaths (10 * 0.75 = 7.5, rounded up to 8)
    206|     expect(actualDeaths).toBeGreaterThanOrEqual(6);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯


 Test Files  1 failed | 22 passed (23)
      Tests  7 failed | 357 passed (364)
   Start at  10:11:16
   Duration  8.33s (transform 3.08s, setup 0ms, import 7.45s, tests 3.10s, environment 10ms)

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
