
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > actionEffects - circular dependency fix > should work with gameActions registered
AssertionError: expected 7 to be +0 // Object.is equality

- Expected
+ Received

- 0
+ 7

 ❯ client/src/game/rules/actionEffects.test.ts:83:36
     81|     const result = applyActionEffects('chopWood', testState);
     82|     expect(result).toBeDefined();
     83|     expect(result.resources!.wood).toBe(0); // Should consume the cost
       |                                    ^
     84|   });
     85| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should apply blacksmith_hammer 10% crafting discount for craftIronAxe
TypeError: Cannot read properties of undefined (reading 'craftIronAxe')
 ❯ client/src/game/rules/actionEffects.test.ts:96:43
     94| 
     95|   it('should apply blacksmith_hammer 10% crafting discount for craftIronAxe', () =…
     96|     const baseCost = (importedGameActions.craftIronAxe.cost as any)["resources.iro…
       |                                           ^
     97| 
     98|     const stateWith: GameState = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should stack crafting discounts from tools and highest storage building for craftIronAxe
TypeError: Cannot read properties of undefined (reading 'craftIronAxe')
 ❯ client/src/game/rules/actionEffects.test.ts:114:43
    112| 
    113|   it('should stack crafting discounts from tools and highest storage building for …
    114|     const baseCost = (importedGameActions.craftIronAxe.cost as any)["resources.iro…
       |                                           ^
    115| 
    116|     const state: GameState = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should handle crafting with maximum discounts for craftIronAxe
TypeError: Cannot read properties of undefined (reading 'craftIronAxe')
 ❯ client/src/game/rules/actionEffects.test.ts:143:43
    141| 
    142|   it('should handle crafting with maximum discounts for craftIronAxe', () => {
    143|     const baseCost = (importedGameActions.craftIronAxe.cost as any)["resources.iro…
       |                                           ^
    144| 
    145|     const state: GameState = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should apply mastermason_chisel 10% building discount for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:182:47
    180| 
    181|   it('should apply mastermason_chisel 10% building discount for buildCabin', () =>…
    182|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    183|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    184| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should apply fortified storehouse 5% building discount for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:202:47
    200| 
    201|   it('should apply fortified storehouse 5% building discount for buildCabin', () =…
    202|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    203|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    204| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should use only highest tier storage building for building cost reduction for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:217:47
    215| 
    216|   it('should use only highest tier storage building for building cost reduction fo…
    217|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    218|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    219| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should stack building discounts from buildings and tools for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:236:47
    234| 
    235|   it('should stack building discounts from buildings and tools for buildCabin', ()…
    236|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    237|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    238| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should apply discounts to multi-tier building costs for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:265:47
    263| 
    264|   it('should apply discounts to multi-tier building costs for buildCabin', () => {
    265|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[2]["resource…
       |                                               ^
    266| 
    267|     const state: GameState = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should handle crafting with maximum discounts for craftIronAxe
TypeError: Cannot read properties of undefined (reading 'craftIronAxe')
 ❯ client/src/game/rules/actionEffects.test.ts:291:43
    289| 
    290|   it('should handle crafting with maximum discounts for craftIronAxe', () => {
    291|     const baseCost = (importedGameActions.craftIronAxe.cost as any)["resources.iro…
       |                                           ^
    292| 
    293|     const state: GameState = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should handle building with maximum discounts for buildCabin
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:321:47
    319| 
    320|   it('should handle building with maximum discounts for buildCabin', () => {
    321|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    322|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    323| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should not apply discounts to non-crafting, non-building actions
TypeError: Cannot read properties of undefined (reading 'wood')
 ❯ client/src/game/rules/actionEffects.test.ts:352:78
    350|   it('should not apply discounts to non-crafting, non-building actions', () => {
    351|     // Test that chopWood doesn't get discounts
    352|     const chopWoodResource = (gameActions.chopWood.effects as any).resources.wood;
       |                                                                              ^
    353|     state.resources.wood = 0;
    354|     state.tools.blacksmith_hammer = true;

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should floor discount calculations correctly for crafting
TypeError: Cannot read properties of undefined (reading 'craftIronSword')
 ❯ client/src/game/rules/actionEffects.test.ts:364:47
    362|   it('should floor discount calculations correctly for crafting', () => {
    363|     // Test that partial costs are floored
    364|     const baseIronCost = (importedGameActions.craftIronSword.cost as any)["resourc…
       |                                               ^
    365| 
    366|     state.resources.iron = baseIronCost;

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/15]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should floor discount calculations correctly for building
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/actionEffects.test.ts:378:47
    376| 
    377|   it('should floor discount calculations correctly for building', () => {
    378|     const baseWoodCost = (importedGameActions.buildCabin.cost as any)[1]["resource…
       |                                               ^
    379|     const baseStoneCost = (importedGameActions.buildCabin.cost as any)[1]["resourc…
    380| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/15]⎯

 FAIL  client/src/game/rules/resourceGains.test.ts > Resource Gain Tests > Building Cost Reductions > mastermason_chisel reduces building costs by 10%
TypeError: Cannot read properties of undefined (reading 'buildCabin')
 ❯ client/src/game/rules/resourceGains.test.ts:535:45
    533| 
    534|       // Get the base cost from game actions
    535|       const baseCost = (importedGameActions.buildCabin.cost as any)[1]["resources.…
       |                                             ^
    536| 
    537|       // Verify the without-chisel cost matches base cost

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/15]⎯


 Test Files  2 failed | 20 passed (22)
      Tests  15 failed | 342 passed (357)
   Start at  15:51:56
   Duration  4.17s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
