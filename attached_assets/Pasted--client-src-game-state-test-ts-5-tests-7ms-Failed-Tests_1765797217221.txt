
 ✓ client/src/game/state.test.ts (5 tests) 7ms

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should apply blacksmith_hammer 15% crafting discount
AssertionError: expected 15 to be 23 // Object.is equality

- Expected
+ Received

- 23
+ 15

 ❯ client/src/game/rules/actionEffects.test.ts:104:41
    102|     const updatesWith = applyActionEffects('craftIronSword', state);
    103|     const expectedCost = Math.floor(150 * 0.85); // 127
    104|     expect(updatesWith.resources!.iron).toBe(150 - expectedCost); // 150 -…
       |                                         ^
    105|   });
    106| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should stack crafting discounts from buildings and tools
AssertionError: expected 23 to be 30 // Object.is equality

- Expected
+ Received

- 30
+ 23

 ❯ client/src/game/rules/actionEffects.test.ts:149:37
    147|     // Total discount: 15% + 5% = 20%
    148|     const expectedCost = Math.floor(150 * 0.8); // 120
    149|     expect(updates.resources!.iron).toBe(150 - expectedCost); // 150 - 120…
       |                                     ^
    150|   });
    151| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should handle crafting with maximum discounts
AssertionError: expected 68 to be 75 // Object.is equality

- Expected
+ Received

- 75
+ 68

 ❯ client/src/game/rules/actionEffects.test.ts:274:37
    272|     // Total discount: 15% + 5% + 5% + 5% + 10% + 10% = 50%
    273|     const expectedCost = Math.floor(150 * 0.5); // 75
    274|     expect(updates.resources!.iron).toBe(150 - expectedCost); // 150 - 75 …
       |                                     ^
    275|   });
    276| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯


 Test Files  1 failed | 11 passed (12)
      Tests  3 failed | 239 passed (242)
   Start at  11:09:22
   Duration  12.95s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
