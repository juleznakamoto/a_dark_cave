⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  client/src/game/rules/events.test.ts > Event System > should trigger events based on conditions
TypeError: Cannot read properties of undefined (reading 'lastAcceptedLevel')
 ❯ Object.condition client/src/game/rules/eventsBoneDevourer.ts:131:29
    129|   id: "boneArmyAttack",
    130|   condition: (state: GameState) =>
    131|     state.boneDevourerState.lastAcceptedLevel >= 6 &&
       |                             ^
    132|     !state.clothing.devourer_crown &&
    133|     state.current_population > 10,
 ❯ Function.checkEvents client/src/game/rules/events.ts:190:33
 ❯ client/src/game/rules/events.test.ts:32:58

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯

 FAIL  client/src/game/rules/events.test.ts > Event System > should not trigger events with unmet conditions
TypeError: Cannot read properties of undefined (reading 'lastAcceptedLevel')
 ❯ Object.condition client/src/game/rules/eventsBoneDevourer.ts:131:29
    129|   id: "boneArmyAttack",
    130|   condition: (state: GameState) =>
    131|     state.boneDevourerState.lastAcceptedLevel >= 6 &&
       |                             ^
    132|     !state.clothing.devourer_crown &&
    133|     state.current_population > 10,
 ❯ Function.checkEvents client/src/game/rules/events.ts:190:33
 ❯ client/src/game/rules/events.test.ts:41:44

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯

 FAIL  client/src/game/rules/resourceGains.test.ts > Resource Gain Tests > Sacrifice Actions > boneTotems with devourer_crown applies +20 silver bonus
AssertionError: expected 10 to be 30 // Object.is equality

- Expected
+ Received

- 30
+ 10

 ❯ client/src/game/rules/resourceGains.test.ts:891:39
    889| 
    890|       // Devourer Crown adds flat +20 silver bonus
    891|       expect(expectedWith.silver.min).toBe(expectedWithout.silver.min + 20);
       |                                       ^
    892|       expect(expectedWith.silver.max).toBe(expectedWithout.silver.max + 20);
    893|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯

 FAIL  client/src/game/rules/resourceGains.test.ts > Resource Gain Tests > Sacrifice Actions > boneTotems with devourer_crown and sacrificial_tunic stacks correctly
AssertionError: expected 12 to be 32 // Object.is equality

- Expected
+ Received

- 32
+ 12

 ❯ client/src/game/rules/resourceGains.test.ts:913:40
    911|       const expectedMax = multipliedMax + 20;
    912| 
    913|       expect(expectedGains.silver.min).toBe(expectedMin);
       |                                        ^
    914|       expect(expectedGains.silver.max).toBe(expectedMax);
    915|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯

 FAIL  client/src/game/rules/resourceGains.test.ts > Resource Gain Tests > Sacrifice Actions > boneTotems with devourer_crown: tooltip matches actual gains
AssertionError: expected 45 to be less than or equal to 25
 ❯ client/src/game/rules/resourceGains.test.ts:939:25
    937|       const maxActual = Math.max(...actualGains.silver);
    938|       expect(minActual).toBeGreaterThanOrEqual(tooltipSilver!.min);
    939|       expect(maxActual).toBeLessThanOrEqual(tooltipSilver!.max);
       |                         ^
    940| 
    941|       // Base 10-25 + 20 bonus = 30-45

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯


 Test Files  2 failed | 21 passed (23)
      Tests  5 failed | 367 passed (372)
   Start at  13:17:54
   Duration  5.46s (transform 1.54s, setup 0ms, import 4.10s, tests 2.13s, environment 4ms)

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
