
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 8 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should apply blacksmith_hammer 10% crafting discount
AssertionError: expected 8 to be 15 // Object.is equality

- Expected
+ Received

- 15
+ 8

 ❯ client/src/game/rules/actionEffects.test.ts:106:41
    104|     // With 10% discount: cost = floor(150 * 0.90) = 135
    105|     // Remaining: 150 - 135 = 15
    106|     expect(updatesWith.resources!.iron).toBe(15);
       |                                         ^
    107|   });
    108| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Crafting Cost Reductions > should stack crafting discounts from tools and highest storage building
AssertionError: expected 15 to be 23 // Object.is equality

- Expected
+ Received

- 23
+ 15

 ❯ client/src/game/rules/actionEffects.test.ts:148:37
    146|     // Cost: floor(150 * 0.85) = 127
    147|     // Remaining: 150 - 127 = 23
    148|     expect(updates.resources!.iron).toBe(23);
       |                                     ^
    149|   });
    150| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should apply mastermason_chisel 10% building discount
AssertionError: expected 8 to be 15 // Object.is equality

- Expected
+ Received

- 15
+ 8

 ❯ client/src/game/rules/actionEffects.test.ts:178:41
    176|     const expectedWoodCost = Math.floor(150 * 0.9); // 135
    177|     const expectedStoneCost = Math.floor(50 * 0.9); // 45
    178|     expect(updatesWith.resources!.wood).toBe(150 - expectedWoodCost); // 150 - 135…
       |                                         ^
    179|     expect(updatesWith.resources!.stone).toBe(50 - expectedStoneCost); // 50 - 45 …
    180|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should stack building discounts from buildings and tools
AssertionError: expected 15 to be 23 // Object.is equality

- Expected
+ Received

- 23
+ 15

 ❯ client/src/game/rules/actionEffects.test.ts:235:37
    233|     const expectedWoodCost = Math.floor(150 * 0.85); // 127
    234|     const expectedStoneCost = Math.floor(50 * 0.85); // 42
    235|     expect(updates.resources!.wood).toBe(150 - expectedWoodCost); // 150 - 127 = 23
       |                                     ^
    236|     expect(updates.resources!.stone).toBe(50 - expectedStoneCost); // 50 - 42 = 8
    237|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Building Cost Reductions > should apply discounts to multi-tier building costs
AssertionError: expected 5 to be 10 // Object.is equality

- Expected
+ Received

- 10
+ 5

 ❯ client/src/game/rules/actionEffects.test.ts:249:37
    247|     // Level 2 costs 100 wood, with 10% discount = 90 wood
    248|     const expectedCost = Math.floor(100 * 0.9); // 90
    249|     expect(updates.resources!.wood).toBe(100 - expectedCost); // 100 - 90 = 10
       |                                     ^
    250|   });
    251| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should handle crafting with maximum discounts
AssertionError: expected 23 to be 30 // Object.is equality

- Expected
+ Received

- 30
+ 23

 ❯ client/src/game/rules/actionEffects.test.ts:276:37
    274|     // Cost: floor(150 * 0.80) = 120
    275|     // Remaining: 150 - 120 = 30
    276|     expect(updates.resources!.iron).toBe(30);
       |                                     ^
    277|     // Note: Only highest tier storage building discount applies (10% from greatVa…
    278|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/8]⎯

 FAIL  client/src/game/rules/actionEffects.test.ts > Cost Reduction Edge Cases > should handle building with maximum discounts
AssertionError: expected 23 to be 30 // Object.is equality

- Expected
+ Received

- 30
+ 23

 ❯ client/src/game/rules/actionEffects.test.ts:295:37
    293|     const expectedWoodCost = Math.floor(150 * 0.8); // 120
    294|     const expectedStoneCost = Math.floor(50 * 0.8); // 40
    295|     expect(updates.resources!.wood).toBe(150 - expectedWoodCost); // 150 - 120 = 30
       |                                     ^
    296|     expect(updates.resources!.stone).toBe(50 - expectedStoneCost); // 50 - 40 = 10
    297|     // Note: Previously was 35% (stacking all), now 20% (only highest tier storage…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/8]⎯

 FAIL  client/src/game/rules/resourceGains.test.ts > Resource Gain Tests > Building Cost Reductions > mastermason_chisel reduces building costs by 10%
AssertionError: expected 142 to be 135 // Object.is equality

- Expected
+ Received

- 135
+ 142

 ❯ client/src/game/rules/resourceGains.test.ts:534:26
    532| 
    533|       // With chisel should cost 10% less
    534|       expect(amountWith).toBe(Math.floor(amountWithout * 0.9));
       |                          ^
    535|     });
    536| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/8]⎯


 Test Files  2 failed | 20 passed (22)
      Tests  8 failed | 345 passed (353)
   Start at  15:48:41
   Duration  9.80s (transform 3.69s, setup 0ms, import 6.16s, tests 4.92s, environment 4ms)

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
